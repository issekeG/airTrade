<aside id="sidebar" class="sidebar">


    <ul class="sidebar-nav" id="sidebar-nav">


        <li class="nav-item">
            <a class="nav-link" href="#">
                <i class="bi bi-funnel"></i>
                <span>Filtre</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" href="#" data-bs-toggle="modal" data-bs-target="#categoryModal">
                <i class="bi bi-tags"></i><span>Catégories</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-toggle="offcanvas" data-bs-target="#manufacturerOffcanvas" href="#">
                <i class="bi bi-building"></i><span>Constructeur</span><i class="bi bi-chevron-right ms-auto"></i>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#year-built-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-calendar3"></i><span>Année de construction</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="year-built-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <select class="form-select form-select-sm" id="sidebarMinYear" name="min_year" aria-label="Année min">
                                <option selected disabled>Année min</option>
                                {% set currentYear = "now"|date("Y") %}
                                {% for year in 1950..currentYear %}
                                    <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                            </select>
                            <label for="sidebarMinYear" class="text-muted fw-normal">Année min</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <select class="form-select form-select-sm" id="sidebarMaxYear" name="max_year" aria-label="Année max">
                                <option selected disabled>Année max</option>
                                {% set currentYear = "now"|date("Y") %}
                                {% for year in 1950..currentYear %}
                                    <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                            </select>
                            <label for="sidebarMaxYear" class="text-muted fw-normal">Année max</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Appliquer</button>
                    </a>
                </li>
            </ul>

        </li>


        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#price-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-cash-coin"></i><span>Prix</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="price-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMinPrice" name="min_price" placeholder="Prix min" min="0">
                            <label for="sidebarMinPrice" class="text-muted fw-normal">Prix min</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMaxPrice" name="max_price" placeholder="Prix max" min="0">
                            <label for="sidebarMaxPrice" class="text-muted fw-normal">Prix max</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Filtrer</button>
                    </a>
                </li>
            </ul>
        </li>

        <li class="nav-item">

            <a class="nav-link collapsed" data-bs-target="#hours-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-clock-history"></i><span>Heures totales</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="hours-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMinHour" name="min_hour" placeholder="nombre d'heure min" min="0">
                            <label for="sidebarMinHour" class="text-muted fw-normal">Nombre d'heure min</label>
                        </div>

                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMaxHour" name="max_hour" placeholder="nombre d'heure max" min="0">
                            <label for="sidebarMaxHour" class="text-muted fw-normal">Nombre d'heure max</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Filtrer</button>
                    </a>
                </li>
            </ul>

        </li>

        <li class="nav-item">

            <a class="nav-link collapsed" data-bs-target="#number-seats-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-person-bounding-box"></i><span>Nombre de sièges</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="number-seats-nav" class="nav-content collapse " data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMinSeat" name="min_seat" placeholder="Nombre de sièges min" min="0">
                            <label for="sidebarMinSeat" class="text-muted fw-normal">Nombre de sièges min</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" id="sidebarMaxSeat" name="max_seat" placeholder="Nombre de sièges max" min="0">
                            <label for="sidebarMaxSeat" class="text-muted fw-normal">Nombre de sièges max</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Appliquer</button>
                    </a>
                </li>
            </ul>

        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#date-published-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-calendar3"></i><span>Date de publication</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="date-published-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="date" class="form-control form-control-sm" id="sidebarMinDate" name="min_date" placeholder="Date de publication min">
                            <label for="sidebarMinDate" class="text-muted fw-normal">Date de publication min</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="date" class="form-control form-control-sm" id="sidebarMaxDate" name="max_date" placeholder="Date de publication max">
                            <label for="sidebarMaxDate" class="text-muted fw-normal">Date de publication max</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Appliquer</button>
                    </a>
                </li>
            </ul>
        </li>
        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#status-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-clipboard-check"></i><span>Status</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="status-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="utilise" id="statusUsed" name="status[]">
                            <label class="form-check-label" for="statusUsed">
                                Utilisé
                            </label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="neuf" id="statusNew" name="status[]">
                            <label class="form-check-label" for="statusNew">
                                Neuf
                            </label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="occasion" id="statusUsedCondition" name="status[]">
                            <label class="form-check-label" for="statusUsedCondition">
                                Occasion
                            </label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Appliquer</button>
                    </a>
                </li>
            </ul>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" href="pages-register.html">
                <i class="bi bi-globe2"></i>
                <span>Pays</span>
            </a>
        </li>

        <li class="nav-item">
            <a class="nav-link collapsed" data-bs-target="#registration-number-nav" data-bs-toggle="collapse" href="#">
                <i class="bi bi-calendar-check"></i><span>Num d'enregistrement</span><i class="bi bi-chevron-down ms-auto"></i>
            </a>
            <ul id="registration-number-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                <li>
                    <a>
                        <div class="form-floating col-12">
                            <input type="text" class="form-control form-control-sm" id="sidebarRegistrationNumber" name="registration_number" placeholder="Numéro d'enregistrement">
                            <label for="sidebarRegistrationNumber" class="text-muted fw-normal">Numéro d'enregistrement</label>
                        </div>
                    </a>
                </li>
                <li>
                    <a>
                        <button class="btn btn-primary btn-sm">Appliquer</button>
                    </a>
                </li>
            </ul>
        </li>

    </ul>



</aside>




<aside id="sidebar" class="sidebar">
    <!-- Formulaire principal (à la racine de la sidebar) -->
    <form id="globalFilterForm" method="GET" action="/filtre">
        <!-- Champs cachés pour les sélections de modals -->
        <input type="hidden" name="categories" id="hiddenCategories" value="">
        <input type="hidden" name="manufacturers" id="hiddenManufacturers" value="">

        <ul class="sidebar-nav" id="sidebar-nav">
            <li class="nav-item">
                <a class="nav-link" href="#">
                    <i class="bi bi-funnel"></i>
                    <span>Filtre</span>
                </a>
            </li>

            <!-- Modal Catégories -->
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-bs-toggle="modal" data-bs-target="#categoryModal">
                    <i class="bi bi-tags"></i><span>Catégories</span><i class="bi bi-chevron-down ms-auto"></i>
                </a>
            </li>

            <!-- Offcanvas Constructeur -->
            <li class="nav-item">
                <a class="nav-link collapsed" data-bs-toggle="offcanvas" data-bs-target="#manufacturerOffcanvas" href="#">
                    <i class="bi bi-building"></i><span>Constructeur</span><i class="bi bi-chevron-right ms-auto"></i>
                </a>
            </li>

            <!-- Année de construction -->
            <li class="nav-item">
                <a class="nav-link collapsed" data-bs-target="#year-built-nav" data-bs-toggle="collapse" href="#">
                    <i class="bi bi-calendar3"></i><span>Année de construction</span><i class="bi bi-chevron-down ms-auto"></i>
                </a>
                <ul id="year-built-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                    <li>
                        <div class="form-floating col-12">
                            <select class="form-select form-select-sm" name="min_year" aria-label="Année min">
                                <option selected disabled>Année min</option>
                                {% set currentYear = "now"|date("Y") %}
                                {% for year in 1950..currentYear %}
                                    <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                            </select>
                            <label class="text-muted fw-normal">Année min</label>
                        </div>
                    </li>
                    <li>
                        <div class="form-floating col-12">
                            <select class="form-select form-select-sm" name="max_year" aria-label="Année max">
                                <option selected disabled>Année max</option>
                                {% set currentYear = "now"|date("Y") %}
                                {% for year in 1950..currentYear %}
                                    <option value="{{ year }}">{{ year }}</option>
                                {% endfor %}
                            </select>
                            <label class="text-muted fw-normal">Année max</label>
                        </div>
                    </li>
                </ul>
            </li>

            <!-- Prix -->
            <li class="nav-item">
                <a class="nav-link collapsed" data-bs-target="#price-nav" data-bs-toggle="collapse" href="#">
                    <i class="bi bi-cash-coin"></i><span>Prix</span><i class="bi bi-chevron-down ms-auto"></i>
                </a>
                <ul id="price-nav" class="nav-content collapse" data-bs-parent="#sidebar-nav">
                    <li>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" name="min_price" placeholder="Prix min" min="0">
                            <label class="text-muted fw-normal">Prix min</label>
                        </div>
                    </li>
                    <li>
                        <div class="form-floating col-12">
                            <input type="number" class="form-control form-control-sm" name="max_price" placeholder="Prix max" min="0">
                            <label class="text-muted fw-normal">Prix max</label>
                        </div>
                    </li>
                </ul>
            </li>

            <!-- ... (autres filtres de la même manière) ... -->

            <!-- Bouton de soumission principal -->
            <li class="nav-item mt-3">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-funnel-fill"></i> Appliquer tous les filtres
                </button>
            </li>
        </ul>
    </form>
</aside>

<!-- Modal Catégories -->
<div class="modal fade" id="categoryModal">
    <div class="modal-body">
        {% for category in categories %}
            <div class="form-check">
                <input class="form-check-input category-checkbox"
                       type="checkbox"
                       value="{{ category.id }}"
                       id="cat-{{ category.id }}">
                <label for="cat-{{ category.id }}">{{ category.name }}</label>
            </div>
        {% endfor %}
        <button class="btn btn-success mt-2" onclick="updateCategorySelection()">
            Valider les catégories
        </button>
    </div>
</div>

<!-- Script de gestion -->
<script>
    // Met à jour les catégories sélectionnées
    function updateCategorySelection() {
        const selected = Array.from(document.querySelectorAll('.category-checkbox:checked'))
            .map(checkbox => checkbox.value);

        document.getElementById('hiddenCategories').value = selected.join(',');
        bootstrap.Modal.getInstance('#categoryModal').hide();
        alert(selected.join(','));
    }

</script>